<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>SocialCalc 0.7.10w</title>
<script type="text/javascript" src="socialcalcconstants.js"></script>
<script type="text/javascript" src="socialcalc-3.js"></script>
<script type="text/javascript" src="socialcalctableeditor.js"></script>
<script type="text/javascript" src="formatnumber2.js"></script>
<script type="text/javascript" src="formula1.js"></script>
<script type="text/javascript" src="socialcalcpopup.js"></script>
<script type="text/javascript" src="socialcalcspreadsheetcontrol.js"></script>
<style>
body, td, input, texarea {font-family:verdana,helvetica,sans-serif;font-size:small;}
.smaller {font-size:smaller;}
</style>
</head>
<body style="background-color:#FFF;" onresize="spreadsheet.DoOnResize();">
<div style="margin:8px 0px 10px 0px;">
 <div id="tableeditor" style="margin:8px 0px 10px 0px;">editor goes here</div>
</div>
 <div id="msg" onclick="this.innerHTML='&nbsp;';"></div>

<script>

function addmsg(str) {document.getElementById("msg").innerHTML += ", "+str;}
function setmsg(str) {document.getElementById("msg").innerHTML = str;}

//   window.onerror = function(m, u, l){ addmsg(m+" at line "+l); return true;};

   // Create the spreadsheet control, but don't initialize yet

   var spreadsheet = new SocialCalc.SpreadsheetControl();
   var savestr = "";

   // Set up the tabs we want

   // Remove Audit

   spreadsheet.tabs.splice(spreadsheet.tabnums.audit, 1);

   spreadsheet.tabnums = {};
   for (var i=0; i<spreadsheet.tabs.length; i++) {
      spreadsheet.tabnums[spreadsheet.tabs[i].name] = i;
      }

   // Add Plain

   spreadsheet.tabnums.plain = spreadsheet.tabs.length;
   spreadsheet.tabs.push({name: "plain", text: "Plain", html:
      '<div id="%id.plaintools" style="display:none;">'+
      ' <div style="%tbt.">&nbsp;</div>'+
      '</div>',
      view: "plain",
      onclick:
         function(s, t) {
            s.views.plain.element.innerHTML = s.CreateSheetHTML();
            },
      onclickFocus: true
      });

   spreadsheet.views["plain"] = {name: "plain",
      divStyle: "border:1px solid black;overflow:auto;",
      html: 'Plain View'
      };

   // Add Graph

   spreadsheet.tabnums.graph = spreadsheet.tabs.length;
   spreadsheet.tabs.push({name: "graph", text: "Graph", html:
      '<div id="%id.graphtools" style="display:none;">'+
      ' <div style="%tbt.">&nbsp;</div>'+
      '</div>',
      view: "graph",
      onclick: DoGraph,
      onclickFocus: true
      });

   spreadsheet.views["graph"] = {name: "graph", divStyle: "overflow:auto;", values: {},
      oncreate: function(s, viewobj) {
         var charttypes = "Horizontal Bar:barh|Vertical Bar:barv|Line:line|Area:area|Scatter:scatter";

         viewobj.values.panel = {
//            charttype: {setting: "charttype", type: "PopupList", id: s.idPrefix+"charttype",
//               initialdata: charttypes},
//            charttitle: {setting: "chartitle", type: "PopupList", id: s.idPrefix+"charttitle",
//               initialdata: null}
            };

         SocialCalc.SettingsControlInitializePanel(viewobj.values.panel);
         },
      replacements: {
         itemtitle: {regex: /\%itemtitle\./g, replacement: 'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},
         sectiontitle: {regex: /\%sectiontitle\./g, replacement: 'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},
         parttitle: {regex: /\%parttitle\./g, replacement: 'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},
         itembody: {regex: /\%itembody\./g, replacement: 'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},
         bodypart: {regex: /\%bodypart\./g, replacement: 'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}
         },

      html:
'<div id="%id.c-colorchooser" style="display:none;position:absolute;z-index:20;"></div>'+
'<table id="%id.chartsettingstable" style="display:none;" cellspacing="0" cellpadding="0">'+
'<table cellspacing="0" cellpadding="0">'+
'<tr>'+
' <td %itemtitle.><br>Chart:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Type</div>'+
'     <select size="1">'+
'      <option>Horizontal Bar</option>'+
'      <option>Vertical Bar</option>'+
'      <option>Line</option>'+
'      <option>Area</option>'+
'      <option>Picture</option>'+
'      <option>Circle</option>'+
'      <option>Scatter Plot</option>'+
'     </select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Title</div>'+
'     <input type="text" size="40" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>X-Axis:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Labels</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Minimum</div>'+
'     <select size="1"><option>Default</option><option>Custom</option></select>'+
'     <input type="text" size="4" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Maximum</div>'+
'     <select size="1"><option>Default</option><option>Custom</option></select>'+
'     <input type="text" size="4" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="20" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Y-Axis:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Minimum</div>'+
'     <select size="1"><option>Default</option><option>Custom</option></select>'+
'     <input type="text" size="4" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Maximum</div>'+
'     <select size="1"><option>Default</option><option>Custom</option></select>'+
'     <input type="text" size="4" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="20" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Series 1:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Data</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Color</div>'+
'     <input type="text" size="6" value="">'+
'     <span style="border:1px solid black;">&nbsp;&nbsp;&nbsp</span>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Symbol</div>'+
'     <select size="1"><option>None</option><option>Custom</option><option>Star</option><option>Box</option></select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="10" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Series 2:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Data</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option><option>[Blank]</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="None">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Color</div>'+
'     <input type="text" size="6" value="">'+
'     <span style="border:1px solid black;">&nbsp;&nbsp;&nbsp</span>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Symbol</div>'+
'     <select size="1"><option>None</option><option>Custom</option><option>Star</option><option>Box</option></select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="10" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Series 3:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Data</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option><option>None</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="None">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Color</div>'+
'     <input type="text" size="6" value="">'+
'     <span style="border:1px solid black;">&nbsp;&nbsp;&nbsp</span>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Symbol</div>'+
'     <select size="1"><option>None</option><option>Custom</option><option>Star</option><option>Box</option></select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="10" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Series 4:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Data</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option><option>None</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="None">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Color</div>'+
'     <input type="text" size="6" value="">'+
'     <span style="border:1px solid black;">&nbsp;&nbsp;&nbsp</span>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Symbol</div>'+
'     <select size="1"><option>None</option><option>Custom</option><option>Star</option><option>Box</option></select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="10" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'<tr>'+
' <td %itemtitle.><br>Series 5:</td>'+
' <td %itembody.>'+
'   <table cellspacing="0" cellpadding="0"><tr>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Data</div>'+
'     <select size="1"><option>A4</option><option>FIRST</option><option>None</option></select>'+
'     <input type="button" value="&gt;">'+
'     <input type="text" size="6" value="None">'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Color</div>'+
'     <input type="text" size="6" value="">'+
'     <span style="border:1px solid black;">&nbsp;&nbsp;&nbsp</span>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Symbol</div>'+
'     <select size="1"><option>None</option><option>Custom</option><option>Star</option><option>Box</option></select>'+
'    </td>'+
'    <td %bodypart.>'+
'     <div %parttitle.>Name</div>'+
'     <input type="text" size="10" value="">'+
'    </td>'+
'   </tr></table>'+
' </td>'+
'</tr>'+
'</table>'
      };

   // Add Help

   spreadsheet.tabnums.help = spreadsheet.tabs.length;
   spreadsheet.tabs.push({name: "help", text: "Help", html:
      '<div id="%id.helptools" style="display:none;">'+
      ' <div style="%tbt.">&nbsp;</div>'+
      '</div>',
      view: "help",
      onclick: DoHelp,
      onclickFocus: true
      });

   spreadsheet.views["help"] = {name: "help",
      divStyle: "border:1px solid black;overflow:auto;",
      html: '<div style="padding:6px;">Help View</div>'
      };

   // Initialize the Spreadsheet Control and display it

   spreadsheet.InitializeSpreadsheetControl("tableeditor");
   spreadsheet.ExecuteCommand('redisplay', '');

   // Done initialization

//
// * * * FUNCTIONS * * *
//

//
// Example of how to get the serialized data
//

function dosave() {
   savestr = spreadsheet.CreateSpreadsheetSave();
   }

//
// Example of how to reload the serialized data
//
// Don't do this when a command or displaying is being executed. It wipes out the sheet without checking.
// (If you do this on an initial load, skip the 'redisplay' above.)
//

// This is just as a demo to show we might have graphing someday. It may be better to have it
// in a different activity.

function DoGraph(objs, t) {
 return;

   }

// This is where loading help text might go:

function DoHelp(s, t) {

   var hview = s.views.help.element;

   var str =
'HELP TEXT FOLLOWED BY ABOUT TEXT AND LEGAL INFORMATION:<br><br> '+
'Version 0.7.10<br><br> ';

   hview.firstChild.innerHTML = str;

   }

</script>
</body>
</html>

